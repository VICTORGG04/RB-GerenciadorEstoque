<div class="row mt-4">
  <!-- Card Valor Total -->
  <div class="col-md-4 mb-3">
    <div class="card text-center shadow">
      <div class="card-body">
        <h5 class="card-title">Valor Total do Estoque</h5>
        <p class="display-6 text-success">R$ <%= '%.2f' % @valor_total %></p>
      </div>
    </div>
  </div>

  <!-- Card Quantidade Total -->
  <div class="col-md-4 mb-3">
    <div class="card text-center shadow">
      <div class="card-body">
        <h5 class="card-title">Quantidade Total</h5>
        <p class="display-6 text-primary"><%= @quantidade_total %></p>
      </div>
    </div>
  </div>

  <!-- Card Produtos Adicionados no Mês -->
  <div class="col-md-4 mb-3">
    <div class="card text-center shadow">
      <div class="card-body">
        <h5 class="card-title">Produtos neste mês</h5>
        <p class="display-6 text-warning"><%= @produtos.size %></p>
      </div>
    </div>
  </div>
</div>

<!-- Gráfico -->
<div class="row mt-4">
  <div class="col-md-12">
    <div class="card shadow">
      <div class="card-body">
        <h5 class="card-title">Valor por Categoria</h5>
        <canvas id="category-chart" height="120"></canvas>
      </div>
    </div>
  </div>
</div>

<script>
    const ctx = document.getElementById('category-chart');
    const labels = <%= @valor_por_categoria.map { |item| item['categoria'] }.to_json %>;
    const data = <%= @valor_por_categoria.map { |item| item['total'] }.to_json %>;

    new Chart(ctx, {
        type: 'pie',
        data: {
            labels: labels,
            datasets: [{
                label: 'Valor por Categoria',
                data: data,
                backgroundColor: ['#0d6efd','#198754','#ffc107','#dc3545','#6c757d','#0dcaf0'],
                borderColor: '#f3f2f2',
                borderWidth: 2,
                hoverOffset: 6
            }]
        },
        options: {
            responsive: true,
            plugins: { legend: { position: 'bottom' } }
        }
    });
</script>
