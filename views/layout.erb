<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistema de Estoque</title>
  <link rel="stylesheet" href="/css/base.css">
  <link rel="stylesheet" href="/css/layout.css">
  <link rel="stylesheet" href="/css/components.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <%# CDN do Chart.js. Deixe aqui ou no dashboard.erb %>
</head>
<body>
<div class="dashboard-grid">
  <aside class="dashboard-sidebar">
    <div class="sidebar-logo-card">
      <h3>ðŸ“Š Sistema de Estoque</h3>
    </div>
    <nav class="sidebar-nav">
      <ul>
        <li><a href="/dashboard" class="nav-link <%= 'active' if request.path_info == '/dashboard' || request.path_info == '/' %>">Dashboard</a></li> <%# Ajustei para /dashboard %>
        <li><a href="/produtos" class="nav-link <%= 'active' if request.path_info.start_with?('/produtos') %>">Produtos</a></li>
        <li><a href="/importar" class="nav-link <%= 'active' if request.path_info == '/importar' %>">Importar</a></li>
        <li><a href="/relatorios" class="nav-link <%= 'active' if request.path_info == '/relatorios' %>">RelatÃ³rios</a></li>
        <li><a href="/movimentacoes" class="nav-link <%= 'active' if request.path_info == '/movimentacoes' %>">MovimentaÃ§Ãµes</a></li>
      </ul>
    </nav>
    <div class="sidebar-footer">
      <a href="/logout" class="btn btn-danger">Sair</a>
    </div>
  </aside>
  <main class="dashboard-main">
    <%# Recomendo usar um container com ID para as flash messages para o JS em app.js lidar com elas %>
    <div id="flash-messages-container"></div>
    <%# O cÃ³digo abaixo Ã© uma forma mais simples, mas o app.js com URLSearchParams Ã© mais robusto %>
    <% if params[:sucesso] %>
      <div class="flash-message success mt-3"><%= h(params[:sucesso]) %></div>
    <% end %>
    <% if params[:erro] %>
      <div class="flash-message error mt-3"><%= h(params[:erro]) %></div>
    <% end %>
    <% if params[:info] %>
      <div class="flash-message info mt-3"><%= h(params[:info]) %></div>
    <% end %>
    <%= yield %>
  </main>
</div>
<script src="/app.js"></script> <%# <<<<<<<<<<<<<<<< CORRIGIDO AQUI! >>>>>>>>>>>>>>>>>> %>
</body>
</html>