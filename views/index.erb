<div class="dashboard-grid">
  <aside class="dashboard-sidebar">
    <div class="card">
      <div class="card-header">Valor Total do Estoque</div>
      <div class="card-title text-primary">R$ <%= '%.2f' % @valor_total %></div>
    </div>
    <div class="card">
      <div class="card-header">Quantidade Total de Itens</div>
      <div class="card-title text-success"><%= @quantidade_total %></div>
    </div>

    <div class="card">
      <div class="card-header">Valor por Categoria (Total)</div>
      <div><canvas id="graficoCategorias" data-grafico='<%= @valor_por_categoria.to_json %>'></canvas></div>
    </div>
  </aside>
  <section class="dashboard-main">
    <div class="table-wrapper">
      <form action="/produtos/excluir" method="POST">
        <div class="d-flex justify-content-between align-items-center p-3">
          <h2>Produtos Adicionados Este Mês</h2>
          <div>
            <a href="/produtos/novo" class="btn btn-primary">Adicionar Produto</a>
            <a href="#" id="btn-editar" class="btn btn-warning" disabled>Editar</a>
            <a href="/importar" class="btn btn-info">Importar</a>
            <button type="submit" id="btn-excluir" class="btn btn-danger" disabled>Excluir</button>
          </div>
        </div>
        <table>
          <thead>
          <tr><th></th><th>Nome</th><th>Categoria</th><th class="text-center">Qtd.</th><th class="text-end">Preço Unit.</th></tr>
          </thead>
          <tbody>
          <% if @produtos.empty? %>
            <tr><td colspan="5" class="text-center p-4">Nenhum produto adicionado este mês.</td></tr>
          <% else %>
            <% @produtos.each do |produto| %>
              <tr>
                <td><input type="checkbox" name="produtos_ids[]" class="produto-checkbox form-check-input" value="<%= produto['id'] %>"></td>
                <td><%= h produto['nome'] %></td><td><%= h produto['categoria'] %></td>
                <td class="text-center"><%= produto['quantidade'] %></td>
                <td class="text-end">R$ <%= '%.2f' % produto['preco'] %></td>
              </tr>
            <% end %>
          <% end %>
          </tbody>
        </table>
      </form>
    </div>
  </section>
</div>